{% extends 'base.html.twig' %}

{% block title %}Prestations{% endblock %}

{% block body %}
<style>
/* === STYLE GLOBAL === */
body {
    background: linear-gradient(135deg, #fff8f2, #fce7d4) !important;
    font-family: 'Poppins', 'Segoe UI', sans-serif !important;
    color: #333 !important;
    margin: 0;
    padding: 0;
}

/* Titres */
h2, h3 {
    font-weight: 600 !important;
    color: #d85c00 !important;
    text-align: center !important;
    margin-top: 1.5rem !important;
}

/* Messages flash */
.alert-success {
    background: linear-gradient(90deg, #ff7b00, #ff9f40) !important;
    color: white !important;
    border: none !important;
    border-radius: 12px !important;
    box-shadow: 0 4px 10px rgba(255, 123, 0, 0.25) !important;
    text-align: center !important;
    font-weight: 500 !important;
}

/* === FORMULAIRE ADMIN === */
form {
    background: #ffffff !important;
    border-radius: 20px !important;
    padding: 40px 40px !important;
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1) !important;
    margin: 2rem auto !important;
    max-width: 800px !important;
}

form label {
    display: block !important;
    font-weight: 600 !important;
    color: #7a4a00 !important;
    margin-bottom: 8px !important;
}

form input, form textarea, form select {
    display: block !important;
    width: 100% !important;
    border-radius: 12px !important;
    border: 1px solid #e1a766 !important;
    padding: 10px 12px !important;
    margin-bottom: 20px !important;
    transition: all 0.2s ease-in-out !important;
}

form input:focus, form textarea:focus, form select:focus {
    border-color: #ff7b00 !important;
    box-shadow: 0 0 0 0.25rem rgba(255, 123, 0, 0.25) !important;
}

/* Bouton principal */
.btn-primary {
    background: linear-gradient(90deg, #ff7b00, #ff9f40) !important;
    border: none !important;
    border-radius: 40px !important;
    font-weight: 600 !important;
    padding: 10px 25px !important;
    letter-spacing: 0.3px !important;
    transition: transform 0.2s ease, box-shadow 0.2s ease !important;
    display: block !important;
    margin: 0 auto !important;
}

.btn-primary:hover {
    transform: translateY(-2px) !important;
    box-shadow: 0 8px 18px rgba(255, 123, 0, 0.3) !important;
}

/* === SECTION PRESTATIONS === */
.prestation {
    background: #fff !important;
    border-radius: 20px !important;
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08) !important;
    transition: all 0.3s ease !important;
    overflow: hidden !important;
    margin: 2rem auto !important;
    max-width: 1000px !important;
    padding: 0 !important;
}

.prestation:hover {
    transform: translateY(-4px) !important;
    box-shadow: 0 12px 30px rgba(255, 123, 0, 0.25) !important;
}

/* Disposition : texte à gauche, image à droite */
.prestation .row {
    display: flex !important;
    align-items: stretch !important;
    flex-wrap: wrap !important;
}

.prestation .col-md-4 {
    order: 1 !important;
    padding: 25px !important;
    display: flex !important;
    align-items: center !important;
}

.prestation .col-md-8 {
    order: 2 !important;
    padding: 0 !important;
    overflow: hidden !important;
}

.prestation img {
    width: 100% !important;
    height: 100% !important;
    max-height: 400px !important;
    object-fit: cover !important;
    border-radius: 0 20px 20px 0 !important;
    transition: transform 0.4s ease !important;
}

.prestation img:hover {
    transform: scale(1.05) !important;
}

.prestation p {
    font-size: 1.1rem !important;
    color: #5a3b00 !important;
    line-height: 1.6 !important;
    margin: 0 !important;
}

/* Texte "aucune image" */
.text-muted {
    color: #a87244 !important;
    font-style: italic !important;
}

/* Responsive */
@media (max-width: 768px) {
    .prestation .row {
        flex-direction: column !important;
    }

    .prestation .col-md-4, .prestation .col-md-8 {
        width: 100% !important;
        order: initial !important;
        border-radius: 0 !important;
        text-align: center !important;
    }

    .prestation img {
        border-radius: 20px 20px 0 0 !important;
        max-height: 300px !important;
    }

    form {
        padding: 25px !important;
    }
}
</style>

<div class="container my-4">

    {% for message in app.flashes('success') %}
        <div class="alert alert-success">{{ message }}</div>
    {% endfor %}

    {% if is_granted('ROLE_ADMIN') %}
        <h2>Ajouter une prestation</h2>
        {{ form_start(form, {'attr': {'enctype': 'multipart/form-data'}}) }}
            {{ form_row(form.article) }}
            {{ form_row(form.imageFile) }}
            <button type="submit" class="btn btn-primary mt-3">Enregistrer</button>
        {{ form_end(form) }}
        <hr class="my-4">
    {% endif %}

    <h3>Liste des prestations</h3>
    {% if prestations is not empty %}
        {% for prestation in prestations %}
            <div class="prestation shadow-sm">
                <div class="row g-0">
                    <div class="col-md-4">
                        <p>{{ prestation.article|raw }}</p>
                    </div>
                    <div class="col-md-8">
                        {% if prestation.image %}
                            <img src="/{{ prestation.image }}" alt="Image de la prestation" class="img-fluid">
                        {% else %}
                            <p class="text-muted text-center mt-4">Aucune image pour cette prestation</p>
                        {% endif %}
                    </div>
                </div>
            </div>
        {% endfor %}
    {% else %}
        <p class="text-muted text-center">Aucune prestation enregistrée pour le moment.</p>
    {% endif %}
</div>
{% endblock %}
